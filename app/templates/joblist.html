{% extends 'base.html' %}


{% block content %}

    <section class="bg-gradient-primary text-white py-4">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h2 class="fw-bold mb-3">Find Your Perfect Job</h2>
                    <div class="card shadow-lg">
                        <div class="card-body">
                            <form class="row g-3" method="get">
    <div class="col-md-4">
        <div class="input-group">
            <span class="input-group-text"><i class="fas fa-search"></i></span>
            <input type="text" class="form-control" name="search" placeholder="Job title, keywords, or company" value="{{ search_query }}">
        </div>
    </div>
    <div class="col-md-3">
        <div class="input-group">
            <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
            <input type="text" class="form-control" name="location" placeholder="Location" value="{{ location_query }}">
        </div>
    </div>
    <div class="col-md-3">
        <select class="form-select" name="job_type">
            <option value="">All Job Types</option>
            <option value="full_time" {% if job_type_query == 'full_time' %}selected{% endif %}>Full-time</option>
            <option value="part_time" {% if job_type_query == 'part_time' %}selected{% endif %}>Part-time</option>
            <option value="contract" {% if job_type_query == 'contract' %}selected{% endif %}>Contract</option>
            <option value="remote" {% if job_type_query == 'remote' %}selected{% endif %}>Remote</option>
            <option value="internship" {% if job_type_query == 'internship' %}selected{% endif %}>Internship</option>
        </select>
    </div>
    <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100">
            <i class="fas fa-search me-2"></i>Search
        </button>
    </div>
</form>

                        </div>
                    </div>
                </div>
                <div class="col-lg-4 text-end">
                    <div class="text-white">
                        <h4 class="fw-bold">{{ jobs_count }}</h4>
                        <p class="mb-0">Jobs Available</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="container py-4">
        <div class="row">

            <!-- Job Listings -->
            <div class="col-lg-12">
                <!-- Results Header -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h5 class="fw-bold mb-1">{{ jobs_count }} Jobs Found</h5>

                    </div>
                    
                </div>


                <div class="row g-4" id="jobListings">
    {% for job in jobs %}
    <div class="col-12">
        <div class="card job-card h-100 shadow-sm">
            <div class="card-body">
                <div class="d-flex align-items-start">
                    {% if job.recruiter.recruiter_profile.profile_picture %}
                        <img src="{{ job.recruiter.recruiter_profile.profile_picture.url }}" 
                            alt="{{ job.recruiter.display_name }}" class="rounded me-3" width="80" height="80">
                    {% else %}
                        <img src="/static/images/placeholder.png" 
                            alt="{{ job.recruiter.display_name }}" class="rounded me-3" width="80" height="80">
                    {% endif %}
                    <div class="flex-grow-1">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div>
                                <h5 class="card-title mb-1">{{ job.title }}</h5>
                                <p class="text-primary mb-1 fw-semibold">{{ job.recruiter.display_name }}</p>
                                <p class="text-muted mb-2">
                                    <i class="fas fa-map-marker-alt me-1"></i>{{ job.location }}
                                    <span class="mx-2">â€¢</span>
                                    <i class="fas fa-clock me-1"></i>Posted {{ job.created_at|timesince }} ago
                                </p>
                            </div>
                            <div class="text-end">
                                <button class="btn btn-outline-danger btn-sm mb-2">
                                    <i class="fas fa-heart"></i>
                                </button>
                                <div>
                                    <span class="badge bg-success">{{ job.match_percentage }}% Match</span>
                                </div>
                            </div>
                        </div>
                        <p class="card-text mb-3">{{ job.description|truncatechars:150 }}</p>
                        
                        <!-- Dynamic Skills -->
                        <div class="d-flex flex-wrap gap-2 mb-3">
                            {% for skill in job.skill_list %}
                                <span class="badge bg-primary">{{ skill }}</span>
                            {% empty %}
                                <span class="text-muted">No skills listed</span>
                            {% endfor %}
                        </div>

                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="badge bg-success me-2">{{ job.get_job_type_display }}</span>
                                {% if job.salary_min and job.salary_max %}
                                    <span class="fw-bold text-success">${{ job.salary_min }} - ${{ job.salary_max }}</span>
                                {% endif %}
                            </div>
                            <div>
                                <a href="{% url 'job_detail' job.id %}" class="btn btn-outline-primary me-2">View Details</a>
                                <a href="" class="btn btn-primary">Apply Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12 text-center text-muted">No jobs available at the moment.</div>
    {% endfor %}
</div>

<!-- Pagination -->
<nav aria-label="Job listings pagination" class="mt-5">
    <ul class="pagination justify-content-center">
        {% if jobs.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page={{ jobs.previous_page_number }}">Previous</a>
            </li>
        {% else %}
            <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
        {% endif %}
        {% for num in jobs.paginator.page_range %}
            <li class="page-item {% if jobs.number == num %}active{% endif %}">
                <a class="page-link" href="?page={{ num }}">{{ num }}</a>
            </li>
        {% endfor %}
        {% if jobs.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ jobs.next_page_number }}">Next</a>
            </li>
        {% else %}
            <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
        {% endif %}
    </ul>
</nav>

            </div>
        </div>
    </div>




{% endblock %}